# These two Suricata rules detect a variant of Monero malware detected
# by NCC Group in the last week.  It may be the same as malware
# reported by ESET at:
#
# https://www.welivesecurity.com/2017/09/28/monero-money-mining-malware/

alert dns any any -> any any (msg:"CDO POLICY DNS request for Monero mining pool, potential coin mining malware"; dns_query; content:"pool.minexmr.com"; priority:2; classtype:misc-activity; sid:1; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CDO POLICY Monero mining pool login message, potential coin mining malware"; flow:to_server,established; content:"|7B 22|id|22|:1,|22|jsonrpc|22|:|22|2.0|22|,|22|method|22|:|22|login|22|"; distance:0; priority:2; classtype:misc-activity; sid:2; rev:1;)